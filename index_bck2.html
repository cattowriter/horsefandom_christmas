<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ü¶ë ‡∏™‡∏∏‡πà‡∏°‡∏ö‡∏±‡∏î‡∏î‡∏µ‡πâ‡πÄ‡∏Å‡∏° Squid Game üéÑ</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;600;700&display=swap');
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Kanit', sans-serif;
            background: linear-gradient(135deg, #0a0a0a 0%, #1a1a2e 50%, #16213e 100%);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 20px;
            position: relative;
            overflow-x: hidden;
        }
        
        /* Background decorations */
        .bg-shapes {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 0;
        }
        
        .shape {
            position: absolute;
            opacity: 0.1;
        }
        
        .circle { 
            width: 100px; 
            height: 100px; 
            border: 3px solid #ff2e63;
            border-radius: 50%;
            top: 10%;
            left: 10%;
        }
        
        .triangle { 
            width: 0;
            height: 0;
            border-left: 50px solid transparent;
            border-right: 50px solid transparent;
            border-bottom: 86px solid #ff2e63;
            top: 70%;
            right: 15%;
        }
        
        .square { 
            width: 80px; 
            height: 80px; 
            background: #ff2e63;
            top: 40%;
            right: 10%;
        }
        
        .container {
            text-align: center;
            max-width: 800px;
            width: 100%;
            position: relative;
            z-index: 1;
        }
        
        h1 {
            color: #ff2e63;
            font-size: 3rem;
            font-weight: 700;
            margin-bottom: 10px;
            text-shadow: 0 0 20px rgba(255, 46, 99, 0.5);
            letter-spacing: 2px;
        }
        
        .subtitle {
            color: #0eb6e3;
            font-size: 1.3rem;
            margin-bottom: 40px;
            font-weight: 300;
        }
        
        .center-image {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 24%;
            height: 24%;
            max-width: 120px;
            max-height: 120px;
            border-radius: 50%;
            object-fit: cover;
            border: 4px solid #ff2e63;
            box-shadow: 0 0 30px rgba(255, 46, 99, 0.8);
            z-index: 5;
        }
        
        .wheel-container {
            position: relative;
            width: 100%;
            max-width: 500px;
            margin: 0 auto 40px;
        }
        
        .wheel-pointer {
            position: absolute;
            top: -20px;
            left: 50%;
            transform: translateX(-50%);
            width: 0;
            height: 0;
            border-left: 15px solid transparent;
            border-right: 15px solid transparent;
            border-top: 30px solid #ff2e63;
            z-index: 10;
            filter: drop-shadow(0 4px 8px rgba(255, 46, 99, 0.5));
        }
        
        canvas {
            width: 100% !important;
            height: auto !important;
            max-width: 500px;
            aspect-ratio: 1;
            border-radius: 50%;
            box-shadow: 0 0 40px rgba(255, 46, 99, 0.4),
                        0 0 80px rgba(14, 182, 227, 0.2);
            background: #1a1a2e;
        }
        
        .button-group {
            display: flex;
            gap: 20px;
            justify-content: center;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        
        .player-controls {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }
        
        .control-btn {
            padding: 10px 25px;
            font-size: 1rem;
            font-family: 'Kanit', sans-serif;
            font-weight: 600;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s ease;
            background: rgba(255, 255, 255, 0.1);
            color: white;
            border: 2px solid rgba(255, 255, 255, 0.3);
        }
        
        .control-btn:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-2px);
        }
        
        .control-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        button {
            padding: 15px 40px;
            font-size: 1.2rem;
            font-family: 'Kanit', sans-serif;
            font-weight: 600;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        #spinBtn {
            background: linear-gradient(135deg, #ff2e63 0%, #ff6b9d 100%);
            color: white;
            box-shadow: 0 8px 20px rgba(255, 46, 99, 0.4);
        }
        
        #spinBtn:hover:not(:disabled) {
            transform: translateY(-3px);
            box-shadow: 0 12px 30px rgba(255, 46, 99, 0.6);
        }
        
        #spinBtn:disabled {
            background: #555;
            cursor: not-allowed;
            box-shadow: none;
            color: #999;
        }
        
        #resetBtn {
            background: linear-gradient(135deg, #0eb6e3 0%, #56c8ff 100%);
            color: white;
            box-shadow: 0 8px 20px rgba(14, 182, 227, 0.4);
        }
        
        #resetBtn:hover {
            transform: translateY(-3px);
            box-shadow: 0 12px 30px rgba(14, 182, 227, 0.6);
        }
        
        .result {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            border: 2px solid rgba(255, 46, 99, 0.3);
            border-radius: 20px;
            padding: 30px;
            margin-top: 30px;
            min-height: 150px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }
        
        .result h2 {
            color: #ff2e63;
            font-size: 1.5rem;
            margin-bottom: 15px;
            font-weight: 600;
        }
        
        .buddy-name {
            color: #0eb6e3;
            font-size: 2.5rem;
            font-weight: 700;
            text-shadow: 0 0 20px rgba(14, 182, 227, 0.5);
            margin: 10px 0;
        }
        
        .couple-tag {
            display: inline-block;
            background: linear-gradient(135deg, #ff2e63 0%, #ff6b9d 100%);
            color: white;
            padding: 8px 20px;
            border-radius: 20px;
            font-size: 0.9rem;
            margin-top: 10px;
            font-weight: 600;
        }
        
        .emoji {
            font-size: 3rem;
            margin: 10px 0;
        }
        
        .players-list {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            border: 2px solid rgba(14, 182, 227, 0.3);
            border-radius: 20px;
            padding: 25px;
            margin-top: 30px;
        }
        
        .players-list h3 {
            color: #0eb6e3;
            margin-bottom: 15px;
            font-size: 1.3rem;
        }
        
        .player-item {
            background: rgba(255, 255, 255, 0.03);
            padding: 12px 20px;
            margin: 8px 0;
            border-radius: 10px;
            color: #fff;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .player-item.selected {
            background: rgba(255, 46, 99, 0.2);
            border-color: #ff2e63;
        }
        
        @media (max-width: 768px) {
            h1 {
                font-size: 1.8rem;
                letter-spacing: 1px;
            }
            
            .subtitle {
                font-size: 1rem;
            }
            
            .wheel-container {
                width: 90vw;
                max-width: 400px;
            }
            
            .wheel-pointer {
                top: -15px;
                border-left: 12px solid transparent;
                border-right: 12px solid transparent;
                border-top: 25px solid #ff2e63;
            }
            
            button {
                padding: 12px 25px;
                font-size: 1rem;
            }
            
            .control-btn {
                padding: 8px 20px;
                font-size: 0.9rem;
            }
            
            .buddy-name {
                font-size: 1.8rem !important;
            }
            
            .result h2 {
                font-size: 1.3rem !important;
            }
            
            .emoji {
                font-size: 2.5rem !important;
            }
            
            .player-item {
                padding: 10px 15px;
                font-size: 0.9rem;
            }
            
            .center-image {
                border-width: 3px;
            }
        }
    </style>
</head>
<body>
    <div class="bg-shapes">
        <div class="shape circle"></div>
        <div class="shape triangle"></div>
        <div class="shape square"></div>
    </div>
    
    <div class="container">
        <h1>üê¥ #‡∏î‡πâ‡∏≠‡∏°‡∏°‡πâ‡∏≤ Secret Santa ü¶Ñ</h1>
        <p class="subtitle">üéÑ ‡∏™‡∏∏‡πà‡∏°‡∏ö‡∏±‡∏î‡∏î‡∏µ‡πâ‡πÄ‡∏•‡πà‡∏ô‡πÄ‡∏Å‡∏°‡∏Ñ‡∏£‡∏¥‡∏™‡∏°‡∏≤‡∏™ üéÑ</p>
        
        <div class="wheel-container">
            <div class="wheel-pointer"></div>
            <canvas id="wheel"></canvas>
            <img src="horse-couple.png" alt="Gi-hun and In-ho" class="center-image" onerror="this.style.display='none'">
        </div>
        
        <div class="button-group">
            <button id="spinBtn">üé≤ ‡∏´‡∏°‡∏∏‡∏ô‡∏ß‡∏á‡∏•‡πâ‡∏≠</button>
            <button id="resetBtn">üîÑ ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï</button>
        </div>
        
        <div class="player-controls">
            <button id="addPlayerBtn" class="control-btn">‚ûï ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏°‡πâ‡∏≤</button>
            <button id="removePlayerBtn" class="control-btn">‚ûñ ‡∏•‡∏î‡∏°‡πâ‡∏≤</button>
            <button id="adminBtn" class="control-btn" style="background: rgba(255, 46, 99, 0.2); border-color: #ff2e63;">üîê ‡πÇ‡∏´‡∏°‡∏î‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô</button>
        </div>
        
        <div class="result" id="result">
            <p style="color: #888; font-size: 1.1rem;">‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏°‡∏´‡∏°‡∏∏‡∏ô‡∏ß‡∏á‡∏•‡πâ‡∏≠‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏™‡∏∏‡πà‡∏°‡∏ö‡∏±‡∏î‡∏î‡∏µ‡πâ üéØ</p>
        </div>
        
        <div id="adminPanel" style="display: none; background: rgba(255, 46, 99, 0.1); border: 2px solid #ff2e63; border-radius: 20px; padding: 25px; margin-top: 30px;">
            <h3 style="color: #ff2e63; margin-bottom: 20px; text-align: center;">‚öôÔ∏è ‡πÇ‡∏´‡∏°‡∏î‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô</h3>
            <div id="adminPlayerList"></div>
            <button id="saveNamesBtn" style="margin-top: 20px; padding: 12px 30px; background: linear-gradient(135deg, #ff2e63 0%, #ff6b9d 100%); color: white; border: none; border-radius: 50px; cursor: pointer; font-family: 'Kanit', sans-serif; font-weight: 600; width: 100%;">üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡∏à‡∏£‡∏¥‡∏á</button>
        </div>
        
        <div class="players-list">
            <h3>üë• ‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</h3>
            <div id="playersList"></div>
        </div>
    </div>

    <script>
        const canvas = document.getElementById('wheel');
        const ctx = canvas.getContext('2d');
        const spinBtn = document.getElementById('spinBtn');
        const resetBtn = document.getElementById('resetBtn');
        const result = document.getElementById('result');
        const playersList = document.getElementById('playersList');
        const addPlayerBtn = document.getElementById('addPlayerBtn');
        const removePlayerBtn = document.getElementById('removePlayerBtn');
        const adminBtn = document.getElementById('adminBtn');
        const saveNamesBtn = document.getElementById('saveNamesBtn');

        // ‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô - ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô 6 ‡∏Ñ‡∏ô
        let players = [
            { name: '‡∏°‡πâ‡∏≤‡πÅ‡∏Ç‡πà‡∏á #1', emoji: 'üê¥', picked: false, realName: '' },
            { name: '‡∏°‡πâ‡∏≤‡πÅ‡∏Ç‡πà‡∏á #2', emoji: 'ü¶Ñ', picked: false, realName: '' },
            { name: '‡∏°‡πâ‡∏≤‡πÅ‡∏Ç‡πà‡∏á #3', emoji: 'üê¥', picked: false, realName: '' },
            { name: '‡∏°‡πâ‡∏≤‡πÅ‡∏Ç‡πà‡∏á #4', emoji: 'ü¶Ñ', picked: false, realName: '' },
            { name: '‡∏°‡πâ‡∏≤‡πÅ‡∏Ç‡πà‡∏á #5', emoji: 'üê¥', picked: false, realName: '' },
            { name: '‡∏°‡πâ‡∏≤‡πÅ‡∏Ç‡πà‡∏á #6', emoji: 'ü¶Ñ', picked: false, realName: '' },
        ];

        const colors = ['#1a1a2e', '#ff2e63', '#00d9a3', '#ffffff', '#1a1a2e', '#ff2e63'];
        const textColors = ['#ffffff', '#ffffff', '#1a1a2e', '#1a1a2e', '#ffffff', '#ffffff'];
        
        let currentAngle = 0;
        let isSpinning = false;
        let pairings = {}; // ‡πÄ‡∏Å‡πá‡∏ö‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏ö‡∏Ñ‡∏π‡πà‡∏Ç‡∏≠‡∏á‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏Ñ‡∏ô
        let isAdminMode = false; // ‡πÇ‡∏´‡∏°‡∏î‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô
        const ADMIN_PASSWORD = 'admin123'; // ‡∏£‡∏´‡∏±‡∏™‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô - ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÑ‡∏î‡πâ

        function drawWheel() {
            const availablePlayers = players.filter(p => !p.picked);
            if (availablePlayers.length === 0) return;
            
            // Set canvas size based on container
            const container = canvas.parentElement;
            const size = Math.min(container.offsetWidth, 500);
            canvas.width = size;
            canvas.height = size;
            
            const centerX = canvas.width / 2;
            const centerY = canvas.height / 2;
            const radius = (canvas.width / 2) * 0.92;
            const sliceAngle = (2 * Math.PI) / availablePlayers.length;

            ctx.clearRect(0, 0, canvas.width, canvas.height);

            availablePlayers.forEach((player, i) => {
                const startAngle = currentAngle + i * sliceAngle;
                const endAngle = startAngle + sliceAngle;

                // Draw slice
                ctx.beginPath();
                ctx.moveTo(centerX, centerY);
                ctx.arc(centerX, centerY, radius, startAngle, endAngle);
                ctx.closePath();
                ctx.fillStyle = colors[i % colors.length];
                ctx.fill();
                ctx.strokeStyle = '#1a1a2e';
                ctx.lineWidth = 3;
                ctx.stroke();

                // Draw text
                ctx.save();
                ctx.translate(centerX, centerY);
                ctx.rotate(startAngle + sliceAngle / 2);
                ctx.textAlign = 'center';
                ctx.fillStyle = textColors[i % textColors.length];
                const fontSize = Math.max(16, Math.min(24, canvas.width / 20));
                ctx.font = `bold ${fontSize}px Kanit`;
                ctx.fillText(player.name, radius / 1.5, fontSize / 3);
                ctx.restore();
            });

            // Draw center circle
            const centerCircleRadius = canvas.width * 0.06;
            ctx.beginPath();
            ctx.arc(centerX, centerY, centerCircleRadius, 0, 2 * Math.PI);
            ctx.fillStyle = '#ff2e63';
            ctx.fill();
            ctx.strokeStyle = '#ffffff';
            ctx.lineWidth = 4;
            ctx.stroke();
        }

        function updatePlayersList() {
            // ‡πÅ‡∏ö‡πà‡∏á‡πÄ‡∏õ‡πá‡∏ô 2 ‡∏Å‡∏•‡∏∏‡πà‡∏°: ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡πÄ‡∏•‡∏∑‡∏≠‡∏Å ‡πÅ‡∏•‡∏∞ ‡∏ñ‡∏π‡∏Å‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÅ‡∏•‡πâ‡∏ß
            const availablePlayers = players.filter(p => !p.picked);
            const pickedPlayers = players.filter(p => p.picked);
            
            let html = '';
            
            // ‡πÅ‡∏™‡∏î‡∏á‡∏°‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏¢‡∏±‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠
            if (availablePlayers.length > 0) {
                html += `<div style="margin-bottom: 20px;">
                    <h4 style="color: #00d9a3; font-size: 1.1rem; margin-bottom: 10px;">üê¥ ‡∏°‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏£‡∏≠‡∏™‡∏∏‡πà‡∏° (${availablePlayers.length} ‡∏ï‡∏±‡∏ß)</h4>`;
                
                availablePlayers.forEach(player => {
                    const horseNum = player.name.match(/#(\d+)/)[1];
                    let displayName = `‡∏°‡πâ‡∏≤ #${horseNum}`;
                    if (isAdminMode && player.realName) {
                        displayName = `‡∏°‡πâ‡∏≤ #${horseNum} (${player.realName})`;
                    }
                    
                    html += `
                        <div class="player-item">
                            <span>${player.emoji} ${displayName}</span>
                            <span style="color: #00d9a3;">‚è≥ ‡∏£‡∏≠‡∏™‡∏∏‡πà‡∏°</span>
                        </div>
                    `;
                });
                html += `</div>`;
            }
            
            // ‡πÅ‡∏™‡∏î‡∏á‡∏Ñ‡∏π‡πà‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÅ‡∏•‡πâ‡∏ß
            if (pickedPlayers.length > 0) {
                html += `<div>
                    <h4 style="color: #ff2e63; font-size: 1.1rem; margin-bottom: 10px;">üíï ‡∏Ñ‡∏π‡πà‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÅ‡∏•‡πâ‡∏ß</h4>`;
                
                const processedPairs = new Set();
                pickedPlayers.forEach(player => {
                    const horseNum = player.name.match(/#(\d+)/)[1];
                    const buddy = pairings[player.name];
                    
                    if (buddy && !processedPairs.has(player.name)) {
                        processedPairs.add(player.name);
                        processedPairs.add(buddy);
                        
                        const buddyNum = buddy.match(/#(\d+)/)[1];
                        let displayName1 = `‡∏°‡πâ‡∏≤ #${horseNum}`;
                        let displayName2 = `‡∏°‡πâ‡∏≤ #${buddyNum}`;
                        
                        if (isAdminMode) {
                            const buddyPlayer = players.find(p => p.name === buddy);
                            if (player.realName) displayName1 = `‡∏°‡πâ‡∏≤ #${horseNum} (${player.realName})`;
                            if (buddyPlayer && buddyPlayer.realName) displayName2 = `‡∏°‡πâ‡∏≤ #${buddyNum} (${buddyPlayer.realName})`;
                        }
                        
                        html += `
                            <div class="player-item selected">
                                <span>${player.emoji} ${displayName1} üíï ${displayName2}</span>
                                <span style="color: #ff2e63;">‚úÖ ‡∏à‡∏±‡∏ö‡∏Ñ‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß</span>
                            </div>
                        `;
                    }
                });
                html += `</div>`;
            }
            
            playersList.innerHTML = html;
        }

        function spin() {
            const availablePlayers = players.filter(p => !p.picked);
            if (availablePlayers.length === 0) {
                result.innerHTML = `
                    <h2>üéä ‡πÄ‡∏Å‡∏°‡∏à‡∏ö‡πÅ‡∏•‡πâ‡∏ß!</h2>
                    <p style="color: #0eb6e3; font-size: 1.2rem; margin-top: 10px;">
                        ‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏ô‡πÑ‡∏î‡πâ‡∏ö‡∏±‡∏î‡∏î‡∏µ‡πâ‡πÅ‡∏•‡πâ‡∏ß ‡∏Å‡∏î‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏•‡πà‡∏ô‡πÉ‡∏´‡∏°‡πà
                    </p>
                `;
                return;
            }
            
            if (availablePlayers.length === 1) {
                result.innerHTML = `
                    <h2>‚ö†Ô∏è ‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏Ñ‡∏ô‡πÄ‡∏î‡∏µ‡∏¢‡∏ß!</h2>
                    <p style="color: #0eb6e3; font-size: 1.2rem; margin-top: 10px;">
                        ‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ 2 ‡∏Ñ‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏à‡∏±‡∏ö‡∏Ñ‡∏π‡πà‡∏ö‡∏±‡∏î‡∏î‡∏µ‡πâ
                    </p>
                `;
                return;
            }
            
            if (isSpinning) return;
            
            isSpinning = true;
            spinBtn.disabled = true;
            
            // ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ß‡πà‡∏≤‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡∏∏‡πà‡∏°
            result.innerHTML = `
                <h2 style="color: #ff2e63; font-size: 1.8rem;">üé≤ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡∏∏‡πà‡∏°...</h2>
                <div class="emoji" style="font-size: 3rem; margin: 20px 0;">üê¥ü¶Ñ</div>
                <p style="color: #0eb6e3; font-size: 1.2rem;">‡∏£‡∏≠‡∏™‡∏±‡∏Å‡∏Ñ‡∏£‡∏π‡πà‡∏ô‡∏∞!</p>
            `;

            const spinDuration = 4000;
            const minRotations = 5;
            
            // ‡∏™‡∏∏‡πà‡∏°‡∏°‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏à‡∏∞‡πÑ‡∏î‡πâ
            const selectedIndex = Math.floor(Math.random() * availablePlayers.length);
            const selected = availablePlayers[selectedIndex];
            
            // ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏°‡∏∏‡∏°‡πÉ‡∏´‡πâ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á
            const sliceAngle = (2 * Math.PI) / availablePlayers.length;
            
            // ‡∏•‡∏π‡∏Å‡∏®‡∏£‡∏≠‡∏¢‡∏π‡πà‡∏ó‡∏µ‡πà‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á 12 ‡∏ô‡∏≤‡∏¨‡∏¥‡∏Å‡∏≤ (‡∏ö‡∏ô‡∏™‡∏∏‡∏î) = 3œÄ/2 ‡∏´‡∏£‡∏∑‡∏≠ -œÄ/2
            // ‡∏ß‡∏á‡∏•‡πâ‡∏≠‡∏ß‡∏≤‡∏î‡∏à‡∏≤‡∏Å‡∏°‡∏∏‡∏° currentAngle
            // Slice ‡∏ó‡∏µ‡πà index 0 ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ó‡∏µ‡πà currentAngle
            // ‡πÄ‡∏£‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡πâ slice ‡∏ó‡∏µ‡πà selectedIndex ‡∏°‡∏≤‡∏≠‡∏¢‡∏π‡πà‡∏ï‡∏£‡∏á‡∏•‡∏π‡∏Å‡∏®‡∏£
            
            // ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏Å‡∏∂‡πà‡∏á‡∏Å‡∏•‡∏≤‡∏á‡∏Ç‡∏≠‡∏á slice ‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å (‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡∏Å‡∏±‡∏ö currentAngle = 0)
            const selectedSliceCenter = selectedIndex * sliceAngle + sliceAngle / 2;
            
            // ‡πÄ‡∏£‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏´‡∏°‡∏∏‡∏ô‡πÑ‡∏õ‡∏à‡∏ô‡∏Å‡∏£‡∏∞‡∏ó‡∏±‡πà‡∏á selectedSliceCenter ‡∏≠‡∏¢‡∏π‡πà‡∏ó‡∏µ‡πà‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏ö‡∏ô‡∏™‡∏∏‡∏î (3œÄ/2)
            // ‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á‡∏à‡∏≤‡∏Å‡∏ß‡∏á‡∏•‡πâ‡∏≠‡∏´‡∏°‡∏∏‡∏ô‡∏ó‡∏ß‡∏ô‡πÄ‡∏Ç‡πá‡∏°‡∏ô‡∏≤‡∏¨‡∏¥‡∏Å‡∏≤ ‡πÅ‡∏•‡∏∞‡πÄ‡∏£‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡πâ slice ‡∏°‡∏≤‡∏≠‡∏¢‡∏π‡πà‡∏ó‡∏µ‡πà‡∏ö‡∏ô
            const pointerPosition = 3 * Math.PI / 2;  // ‡∏ö‡∏ô‡∏™‡∏∏‡∏î
            
            // ‡∏´‡∏≤‡∏°‡∏∏‡∏°‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏´‡∏°‡∏∏‡∏ô‡πÄ‡∏û‡∏¥‡πà‡∏° (‡∏ô‡∏±‡∏ö‡∏à‡∏≤‡∏Å currentAngle ‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô)
            let targetRotation = pointerPosition - selectedSliceCenter;
            
            // ‡∏õ‡∏£‡∏±‡∏ö‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡πà‡∏≤‡∏ö‡∏ß‡∏Å
            while (targetRotation < 0) {
                targetRotation += 2 * Math.PI;
            }
            
            // ‡∏ö‡∏ß‡∏Å‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏£‡∏≠‡∏ö‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏´‡∏°‡∏∏‡∏ô
            const totalRotation = minRotations * 2 * Math.PI + targetRotation;
            
            const startTime = Date.now();
            const startAngle = currentAngle;

            function animate() {
                const elapsed = Date.now() - startTime;
                const progress = Math.min(elapsed / spinDuration, 1);
                const easeOut = 1 - Math.pow(1 - progress, 3);
                
                currentAngle = startAngle + totalRotation * easeOut;
                drawWheel();

                if (progress < 1) {
                    requestAnimationFrame(animate);
                } else {
                    finishSpin(availablePlayers, selected);
                }
            }

            animate();
        }
        
        function finishSpin(availablePlayers, selected) {
            // ‡πÅ‡∏™‡∏î‡∏á‡∏ß‡πà‡∏≤‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏à‡∏±‡∏ö‡∏Ñ‡∏π‡πà‡∏°‡πâ‡∏≤‡∏ï‡∏±‡∏ß‡πÑ‡∏´‡∏ô
            const selectedNum = selected.name.match(/#(\d+)/)[1];
            result.innerHTML = `
                <h2 style="color: #ff2e63; font-size: 1.8rem;">‚ö° ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏à‡∏±‡∏ö‡∏Ñ‡∏π‡πà...</h2>
                <div class="emoji" style="font-size: 4rem; margin: 20px 0;">${selected.emoji}</div>
                <p style="color: #ffffff; font-size: 1.5rem; font-weight: 600;">‡∏°‡πâ‡∏≤‡πÅ‡∏Ç‡πà‡∏á #${selectedNum}</p>
                <p style="color: #0eb6e3; font-size: 1.1rem; margin-top: 10px;">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏´‡∏≤‡∏Ñ‡∏π‡πà...</p>
            `;
            
            // ‡∏£‡∏≠ 1 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ‡∏Å‡πà‡∏≠‡∏ô‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•
            setTimeout(() => {
                const availableBuddies = availablePlayers.filter(p => p.name !== selected.name);
                const buddyIndex = Math.floor(Math.random() * availableBuddies.length);
                const buddy = availableBuddies[buddyIndex];
                
                selected.picked = true;
                buddy.picked = true;
                
                pairings[selected.name] = buddy.name;
                pairings[buddy.name] = selected.name;
                
                showResult(selected, buddy);
                isSpinning = false;
                spinBtn.disabled = false;
                updatePlayersList();
            }, 1000);
        }

        function showResult(player, buddy) {
            // ‡πÅ‡∏¢‡∏Å‡πÄ‡∏•‡∏Ç‡∏°‡πâ‡∏≤‡∏≠‡∏≠‡∏Å‡∏°‡∏≤
            const playerNum = player.name.match(/#(\d+)/)[1];
            const buddyNum = buddy.name.match(/#(\d+)/)[1];
            
            let html = `
                <h2 style="color: #ff2e63; font-size: 2rem; margin-bottom: 20px;">üéâ ‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏™‡∏∏‡πà‡∏°</h2>
                <div style="display: flex; align-items: center; justify-content: center; gap: 30px; flex-wrap: wrap;">
                    <div style="text-align: center;">
                        <div class="emoji" style="font-size: 4rem;">${player.emoji}</div>
                        <div class="buddy-name" style="font-size: 2.5rem; color: #ff2e63;">‡∏°‡πâ‡∏≤ #${playerNum}</div>
                    </div>
                    <div style="font-size: 3rem; color: #ff2e63;">üíï</div>
                    <div style="text-align: center;">
                        <div class="emoji" style="font-size: 4rem;">${buddy.emoji}</div>
                        <div class="buddy-name" style="font-size: 2.5rem; color: #0eb6e3;">‡∏°‡πâ‡∏≤ #${buddyNum}</div>
                    </div>
                </div>
                <div class="couple-tag" style="margin-top: 25px; font-size: 1.1rem;">üê¥ ‡∏Ñ‡∏π‡πà‡∏ö‡∏±‡∏î‡∏î‡∏µ‡πâ‡∏Ñ‡∏£‡∏¥‡∏™‡∏°‡∏≤‡∏™ ü¶Ñ</div>
                <p style="color: #ffffff; margin-top: 20px; font-size: 1.2rem; font-weight: 600;">
                    ‡∏°‡πâ‡∏≤ #${playerNum} ‡∏à‡∏±‡∏ö‡∏Ñ‡∏π‡πà‡∏Å‡∏±‡∏ö ‡∏°‡πâ‡∏≤ #${buddyNum}
                </p>
                <p style="color: #0eb6e3; margin-top: 10px; font-size: 1rem;">
                    ‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡πà‡∏ô‡πÄ‡∏Å‡∏°‡∏Ñ‡∏£‡∏¥‡∏™‡∏°‡∏≤‡∏™‡∏î‡πâ‡∏ß‡∏¢‡∏Å‡∏±‡∏ô‡∏ô‡∏∞! üéÑ
                </p>
            `;
            
            result.innerHTML = html;
        }

        function reset() {
            if (isSpinning) return;
            
            players.forEach(p => p.picked = false);
            pairings = {};
            currentAngle = 0;
            result.innerHTML = `
                <p style="color: #888; font-size: 1.1rem;">‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏°‡∏´‡∏°‡∏∏‡∏ô‡∏ß‡∏á‡∏•‡πâ‡∏≠‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏™‡∏∏‡πà‡∏°‡∏ö‡∏±‡∏î‡∏î‡∏µ‡πâ üéØ</p>
            `;
            updatePlayersList();
            drawWheel();
        }
        
        function addPlayer() {
            if (isSpinning) return;
            
            const nextNumber = players.length + 1;
            const emoji = nextNumber % 2 === 1 ? 'üê¥' : 'ü¶Ñ';
            players.push({
                name: `‡∏°‡πâ‡∏≤‡πÅ‡∏Ç‡πà‡∏á #${nextNumber}`,
                emoji: emoji,
                picked: false,
                realName: ''
            });
            
            updatePlayersList();
            drawWheel();
            if (isAdminMode) {
                updateAdminPanel();
            }
        }
        
        function removePlayer() {
            if (isSpinning) return;
            if (players.length <= 2) {
                alert('‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ 2 ‡∏Ñ‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏•‡πà‡∏ô‡πÄ‡∏Å‡∏°!');
                return;
            }
            
            // ‡∏•‡∏ö‡∏Ñ‡∏ô‡∏™‡∏∏‡∏î‡∏ó‡πâ‡∏≤‡∏¢‡∏ó‡∏µ‡πà‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡πÄ‡∏•‡∏∑‡∏≠‡∏Å
            for (let i = players.length - 1; i >= 0; i--) {
                if (!players[i].picked) {
                    players.splice(i, 1);
                    break;
                }
            }
            
            updatePlayersList();
            drawWheel();
            if (isAdminMode) {
                updateAdminPanel();
            }
        }
        
        function toggleAdminMode() {
            if (!isAdminMode) {
                const password = prompt('üîê ‡∏õ‡πâ‡∏≠‡∏ô‡∏£‡∏´‡∏±‡∏™‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô:');
                if (password === ADMIN_PASSWORD) {
                    isAdminMode = true;
                    document.getElementById('adminPanel').style.display = 'block';
                    document.getElementById('adminBtn').textContent = 'üîì ‡∏õ‡∏¥‡∏î‡πÇ‡∏´‡∏°‡∏î‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô';
                    document.getElementById('adminBtn').style.background = 'rgba(0, 217, 163, 0.2)';
                    document.getElementById('adminBtn').style.borderColor = '#00d9a3';
                    updateAdminPanel();
                    updatePlayersList();
                } else if (password !== null) {
                    alert('‚ùå ‡∏£‡∏´‡∏±‡∏™‡∏ú‡∏¥‡∏î!');
                }
            } else {
                isAdminMode = false;
                document.getElementById('adminPanel').style.display = 'none';
                document.getElementById('adminBtn').textContent = 'üîê ‡πÇ‡∏´‡∏°‡∏î‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô';
                document.getElementById('adminBtn').style.background = 'rgba(255, 46, 99, 0.2)';
                document.getElementById('adminBtn').style.borderColor = '#ff2e63';
                updatePlayersList();
            }
        }
        
        function updateAdminPanel() {
            const adminPlayerList = document.getElementById('adminPlayerList');
            adminPlayerList.innerHTML = players.map((player, index) => `
                <div style="margin-bottom: 15px;">
                    <label style="color: #fff; display: block; margin-bottom: 5px; font-weight: 600;">
                        ${player.emoji} ${player.name}
                    </label>
                    <input 
                        type="text" 
                        id="realName_${index}" 
                        value="${player.realName}" 
                        placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏à‡∏£‡∏¥‡∏á"
                        style="width: 100%; padding: 10px; border-radius: 10px; border: 2px solid rgba(255, 255, 255, 0.2); background: rgba(255, 255, 255, 0.1); color: white; font-family: 'Kanit', sans-serif;"
                    >
                </div>
            `).join('');
        }
        
        function saveRealNames() {
            players.forEach((player, index) => {
                const input = document.getElementById(`realName_${index}`);
                if (input) {
                    player.realName = input.value;
                }
            });
            updatePlayersList();
            alert('‚úÖ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡∏à‡∏£‡∏¥‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢!');
        }
        
        spinBtn.addEventListener('click', spin);
        resetBtn.addEventListener('click', reset);
        addPlayerBtn.addEventListener('click', addPlayer);
        removePlayerBtn.addEventListener('click', removePlayer);
        adminBtn.addEventListener('click', toggleAdminMode);
        saveNamesBtn.addEventListener('click', saveRealNames);
        
        // Redraw on window resize
        let resizeTimeout;
        window.addEventListener('resize', () => {
            clearTimeout(resizeTimeout);
            resizeTimeout = setTimeout(() => {
                drawWheel();
            }, 100);
        });

        // Initialize
        updatePlayersList();
        drawWheel();
    </script>
</body>
</html>
